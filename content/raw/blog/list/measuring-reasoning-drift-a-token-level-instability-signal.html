<main id="page-blog-list-measuring-reasoning-drift-a-token-level-instability-signal" class="super-content page__blog-list-measuring-reasoning-drift-a-token-level-instability-signal parent-page__blog-list"><div class="super-navbar__breadcrumbs" style="position:absolute"><div class="notion-breadcrumb"><a id="block-8d6dfeef4c7f4d678b4899d2198877cb" href="/" class="notion-link notion-breadcrumb__item"><div class="notion-navbar__title notion-breadcrumb__title">Hi there!</div></a><span class="notion-breadcrumb__divider">/</span><a id="block-blog" href="/blog" class="notion-link notion-breadcrumb__item"><div class="notion-navbar__title notion-breadcrumb__title">Blog</div></a><span class="notion-breadcrumb__divider">/</span><a id="block-blog-list" href="/blog/list" class="notion-link notion-breadcrumb__item"><div class="notion-navbar__title notion-breadcrumb__title">List</div></a><span class="notion-breadcrumb__divider">/</span><a id="block-blog-list-measuring-reasoning-drift-a-token-level-instability-signal" href="/blog/list/measuring-reasoning-drift-a-token-level-instability-signal" class="notion-link notion-breadcrumb__item"><div class="notion-navbar__title notion-breadcrumb__title">Measuring Reasoning Drift: A Token-Level Instability Signal</div></a></div></div><div class="notion-header page"><div class="notion-header__cover no-cover no-icon"></div><div class="notion-header__content max-width no-cover no-icon"><div class="notion-header__title-wrapper"><h1 class="notion-header__title">Measuring Reasoning Drift: A Token-Level Instability Signal</h1></div></div></div><article id="block-blog-list-measuring-reasoning-drift-a-token-level-instability-signal" class="notion-root max-width has-footer"><div class="notion-page__properties"><div class="notion-page__property"><div class="notion-page__property-name-wrapper"><div class="notion-page__property-icon-wrapper"><svg viewBox="0 0 16 16" style="width:16px;height:16px"><path d="M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"></path></svg></div><div class="notion-page__property-name"><span>Date</span></div></div><div class="notion-property notion-property__date property-5d71516e notion-semantic-string"><span class="date">February 6, 2026</span></div></div><div class="notion-page__property"><div class="notion-page__property-name-wrapper"><div class="notion-page__property-icon-wrapper"><svg viewBox="0 0 16 16" style="width:16px;height:16px"><path d="M10.9536 7.90088C12.217 7.90088 13.2559 6.79468 13.2559 5.38525C13.2559 4.01514 12.2114 2.92017 10.9536 2.92017C9.70142 2.92017 8.65137 4.02637 8.65698 5.39087C8.6626 6.79468 9.69019 7.90088 10.9536 7.90088ZM4.4231 8.03003C5.52368 8.03003 6.42212 7.05859 6.42212 5.83447C6.42212 4.63843 5.51245 3.68945 4.4231 3.68945C3.33374 3.68945 2.41846 4.64966 2.41846 5.84009C2.42407 7.05859 3.32251 8.03003 4.4231 8.03003ZM1.37964 13.168H5.49561C4.87231 12.292 5.43384 10.6074 6.78711 9.51807C6.18628 9.14746 5.37769 8.87231 4.4231 8.87231C1.95239 8.87231 0.262207 10.6917 0.262207 12.1628C0.262207 12.7974 0.548584 13.168 1.37964 13.168ZM7.50024 13.168H14.407C15.4009 13.168 15.7322 12.8423 15.7322 12.2864C15.7322 10.8489 13.8679 8.88354 10.9536 8.88354C8.04492 8.88354 6.17505 10.8489 6.17505 12.2864C6.17505 12.8423 6.50635 13.168 7.50024 13.168Z"></path></svg></div><div class="notion-page__property-name"><span>Author</span></div></div><div class="notion-property notion-property__person property-5d51766e notion-semantic-string no-wrap"><span class="individual-with-image"><div class="individual-letter-avatar">J</div><span>Jinkun Chen</span></span></div></div><div id="block-root-divider" class="notion-divider"></div></div><p id="block-0bc802a8b52049ceb5179f2f2b9cb679" class="notion-text notion-text__content notion-semantic-string"><em>How to detect process-level breakdowns from token probabilities before the final answer fails.</em></p><ul id="block-050ffd7ad69442ddbec41dc1f48e7e47" class="notion-table-of-contents color-gray"><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-19437b6d40764afca5f474ac9e41cac8"><div class="notion-semantic-string" style="margin-inline-start: 0px;">Can we measure when reasoning starts to drift?</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-a370a179b0064c54be2999783e037042"><div class="notion-semantic-string" style="margin-inline-start: 0px;">What we can observe during decoding</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-81efe9a692ae4ad5973736522ba4683d"><div class="notion-semantic-string" style="margin-inline-start: 0px;">A simple instability signal</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-743ebc5b40764c028e3f24b38d151ef9"><div class="notion-semantic-string" style="margin-inline-start: 0px;">What changes when reasoning is unstable?</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-f12f0cbbe5a14f5aaf4c8f2933f1fb6e"><div class="notion-semantic-string" style="margin-inline-start: 0px;">Does instability actually predict failure?</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-5912bcc0e4124ac192301f09ecbfd6f6"><div class="notion-semantic-string" style="margin-inline-start: 0px;">Early warning: you don’t need the whole trace</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-8b535b7ab47541409db359fdea9affef"><div class="notion-semantic-string" style="margin-inline-start: 0px;">Timing matters: corrective vs destructive instability</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-9ebf131ffece47c58f2c63b5a49e56e8"><div class="notion-semantic-string" style="margin-inline-start: 0px;">A small but important limitation: stable-but-wrong failures</div></a></li><li class="notion-table-of-contents__item"><a class="notion-link" href="#block-a3a321232c8b4c90b1907198523cb387"><div class="notion-semantic-string" style="margin-inline-start: 0px;">What this diagnostic is (and is not)</div></a></li></ul><div id="block-62248757c5b2466390031bdb4d12fd4d" class="notion-divider"></div><p id="block-085dc5bef8ce4346929ea5a98bf51dd0" class="notion-text notion-text__content notion-semantic-string">People often describe LLM mistakes as sudden failures: one moment the answer looks coherent, and the next it collapses.</p><p id="block-5b37437daeaa4a09af85fd19d6954efe" class="notion-text notion-text__content notion-semantic-string">But in many reasoning tasks, a model is not jumping straight from question to conclusion. It is stepping through a sequence of decisions. Small deviations early can quietly reshape everything downstream.</p><p id="block-78758ba10e894cb69100b4bb1ecc46cc" class="notion-text notion-text__content notion-semantic-string">The natural question is:</p><span class="notion-heading__anchor" id="19437b6d40764afca5f474ac9e41cac8"></span><h2 id="block-19437b6d40764afca5f474ac9e41cac8" class="notion-heading notion-semantic-string">Can we <em>measure</em> when reasoning starts to drift?</h2><p id="block-b21fca9b74d94c5785e008087367896d" class="notion-text notion-text__content notion-semantic-string">Not by reading chain-of-thought (which can be incomplete or unfaithful), but by looking at what every decoder produces anyway: a probability distribution over the next token.</p><p id="block-1b4471296339428c95ca4f6cdd13d98d" class="notion-text notion-text__content notion-semantic-string">In this post I’ll walk through a simple <strong>inference-time diagnostic</strong> for reasoning drift:</p><ul class="notion-bulleted-list"><li id="block-9c0acb6eb9b7401eae225e5a7840be1c" class="notion-list-item notion-semantic-string"><strong>Training-free</strong> (no fine-tuning).</li><li id="block-3833c4a306714a0c98b7e284bd66a045" class="notion-list-item notion-semantic-string"><strong>Black-box</strong> (works with logged token probabilities / log-probabilities).</li><li id="block-2d96954220c84c5d9e8ec16a6d2cf9a3" class="notion-list-item notion-semantic-string"><strong>Process-level</strong> (measures how the <em>trajectory</em> evolves, not just the final answer).</li></ul><div id="block-a36c9d6d6f1547dbb40ce09929dbffef" class="notion-divider"></div><span class="notion-heading__anchor" id="a370a179b0064c54be2999783e037042"></span><h2 id="block-a370a179b0064c54be2999783e037042" class="notion-heading notion-semantic-string">What we can observe during decoding</h2><p id="block-25a8c4ac13eb42d2b21386db904cacc0" class="notion-text notion-text__content notion-semantic-string">At each decoding step <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span>, an autoregressive model induces a next-token distribution <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_t(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span>.</p><p id="block-a58e79b1a31f4ddd8203d5043f0b04e8" class="notion-text notion-text__content notion-semantic-string">In many APIs, we can only log the top candidates (top-<span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> tokens) with their log-probabilities. So we work with a truncated, renormalized distribution <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>p</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{p}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> over the logged support.</p><p id="block-06c048039ade41b387f804b5694cef5f" class="notion-text notion-text__content notion-semantic-string">From <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>p</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{p}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, we compute two lightweight signals:</p><ol type="1" class="notion-numbered-list"><li id="block-c023a76de1ac4f92a77b2389125e9f67" class="notion-list-item notion-semantic-string"><strong>Uncertainty</strong> (entropy): when the model is “near a tie” among multiple plausible next tokens.</li><li id="block-dbafe32a2a00467eb8d2e808b1ec4a5b" class="notion-list-item notion-semantic-string"><strong>Distributional change</strong> (Jensen-Shannon divergence, JSD): when the model’s next-token distribution shifts abruptly from one step to the next.</li></ol><p id="block-e783283b2c224b208f72e499b4a89ae1" class="notion-text notion-text__content notion-semantic-string">Intuition:</p><ul class="notion-bulleted-list"><li id="block-c62579802c7f4b1ba5d62a6bbb1df378" class="notion-list-item notion-semantic-string">High entropy = the model is unsure <em>right now</em>.</li><li id="block-c99bccec4f9644f4b9488841cb8f6c1f" class="notion-list-item notion-semantic-string">High JSD = the model’s “belief over next moves” just changed sharply.</li></ul><div id="block-ece9534fea9b457a8085c12f8e527f98" class="notion-divider"></div><span class="notion-heading__anchor" id="81efe9a692ae4ad5973736522ba4683d"></span><h2 id="block-81efe9a692ae4ad5973736522ba4683d" class="notion-heading notion-semantic-string">A simple instability signal</h2><p id="block-958863e2d5de448f824896a87db473fb" class="notion-text notion-text__content notion-semantic-string">We combine the two into a per-step instability index:</p><span id="block-940144a3527d4659b3a657f7c2cc7345" class="notion-equation notion-equation__block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub><mo>=</mo><msub><mi>D</mi><mi>t</mi></msub><mo>+</mo><mi>λ</mi><msub><mi>H</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">I_t = D_t + \lambda H_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">λ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span><p id="block-b85175999f7d41b7be40f4b06df30d8c" class="notion-text notion-text__content notion-semantic-string">where <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">H_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is entropy, <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">D_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> is JSD between consecutive steps, and <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> is a fixed mixing weight (I use <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span> as a simple reference).</p><p id="block-06acca15bb4f4869af14076e18ecea4a" class="notion-text notion-text__content notion-semantic-string">To summarize an entire reasoning trace, we use the <strong>peak instability strength</strong>:</p><ul class="notion-bulleted-list"><li id="block-808893df9d834cc997730e9f27188acc" class="notion-list-item notion-semantic-string"><span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>t</mi></msub><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S = \max_t I_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></li></ul><p id="block-73a22e7b622748fd90c53e7f5cbabe2e" class="notion-text notion-text__content notion-semantic-string">And to check “early warning” behavior (to control for length), we also use prefix windows:</p><ul class="notion-bulleted-list"><li id="block-6d4b1188edec44fe8e3a2404e0e10c47" class="notion-list-item notion-semantic-string"><span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>w</mi></msub><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>t</mi><mo>≤</mo><mi>w</mi></mrow></msub><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_w = \max_{t \leq w} I_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9285em;vertical-align:-0.2452em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2952em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2452em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> for windows like <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>10</mn><mo separator="true">,</mo><mn>20</mn><mo separator="true">,</mo><mn>50</mn><mo separator="true">,</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">w = 10, 20, 50, 100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">20</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">100</span></span></span></span></span>.</li></ul><div id="block-7af9c0625d0a492786b82dd6d013b8a5" class="notion-divider"></div><span class="notion-heading__anchor" id="743ebc5b40764c028e3f24b38d151ef9"></span><h2 id="block-743ebc5b40764c028e3f24b38d151ef9" class="notion-heading notion-semantic-string">What changes when reasoning is unstable?</h2><p id="block-abf6084ec613482fadc131a72807f141" class="notion-text notion-text__content notion-semantic-string">A useful mental model is that decoding is a closed-loop system: each chosen token becomes part of the next input. If the trajectory enters a “fragile” region, a small step-to-step deviation can amplify.</p><p id="block-9f348714a51f448ca1f7e698095a09f9" class="notion-text notion-text__content notion-semantic-string">Empirically, instability spikes often coincide with:</p><ul class="notion-bulleted-list"><li id="block-64393cecf5f245b9affefcd244cbefe9" class="notion-list-item notion-semantic-string"><strong>Support turnover</strong>: the set of highly probable next tokens changes sharply.</li><li id="block-efbfcb5eb0f048fcb4950030b2c90fd8" class="notion-list-item notion-semantic-string"><strong>Near-ties</strong>: the top candidates are close, so small shifts can flip the preferred continuation.</li></ul><p id="block-c335a0e459364d01b55700f9881e063d" class="notion-text notion-text__content notion-semantic-string">These show up directly in <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>p</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{p}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, so we do not need hidden states.</p><div id="block-475200efec1448e9aec6fe56d5e9e01d" class="notion-divider"></div><span class="notion-heading__anchor" id="f12f0cbbe5a14f5aaf4c8f2933f1fb6e"></span><h2 id="block-f12f0cbbe5a14f5aaf4c8f2933f1fb6e" class="notion-heading notion-semantic-string">Does instability actually predict failure?</h2><p id="block-14abb6ab8c5c4f079bfdbc1fb9899025" class="notion-text notion-text__content notion-semantic-string">As a <em>diagnostic</em>, it’s often predictive.</p><p id="block-43fff3951da2485d858f736645e7c36a" class="notion-text notion-text__content notion-semantic-string">For example, in one representative GSM8K run (first 300 test problems; greedy decoding), peak instability strength <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> predicts wrong answers with ROC-AUC ≈ 0.66.</p><p id="block-a32f254ec7df44f3afeafb7dd13bb264" class="notion-text notion-text__content notion-semantic-string">The most interpretable view is <strong>bucket trends</strong>:</p><ul class="notion-bulleted-list"><li id="block-7dd0ef10a6d34ceb8a680566d8efb1ea" class="notion-list-item notion-semantic-string">Sort examples by <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span>.</li><li id="block-371f924282214a68a64e55f8e32f185e" class="notion-list-item notion-semantic-string">Split into 5 equal-sized buckets.</li><li id="block-ecf1c097af1046f0b8044aa73594fb05" class="notion-list-item notion-semantic-string">Accuracy is much higher in the lowest-instability bucket, and remains low in the higher-instability buckets.</li></ul><div id="block-f5dc16e5f74d454ca907e45ea4e320de" class="notion-image page-width"><span data-full-size="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/bf45158f-b3f2-49ab-8027-ad5ba6c69e3c/bucket_trends_gsm8k300_llama_greedy/public" data-lightbox-src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/bf45158f-b3f2-49ab-8027-ad5ba6c69e3c/bucket_trends_gsm8k300_llama_greedy/public" style="display:contents"><img alt="Figure 1. Bucketed accuracy across five equal-sized buckets by peak instability strength " loading="lazy" width="1000" height="1000" decoding="async" data-nimg="1" style="color:transparent;height:auto" srcset="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/bf45158f-b3f2-49ab-8027-ad5ba6c69e3c/bucket_trends_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 1x, https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/bf45158f-b3f2-49ab-8027-ad5ba6c69e3c/bucket_trends_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 2x" src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/bf45158f-b3f2-49ab-8027-ad5ba6c69e3c/bucket_trends_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down"></span><figcaption class="notion-caption notion-semantic-string">Figure 1. Bucketed accuracy across five equal-sized buckets by peak instability strength <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span> (GSM8K-300; greedy decoding).</figcaption></div><p id="block-06c1a552257f414fa664d59955743c8f" class="notion-text notion-text__content notion-semantic-string">Takeaway:</p><blockquote id="block-10946ccb0bb34d5b8b2e7613750162b2" class="notion-quote"><span class="notion-semantic-string">Higher instability strength corresponds to a higher risk of reasoning failure.</span></blockquote><div id="block-afa34d71a6a04e8f82908cead37fc752" class="notion-divider"></div><span class="notion-heading__anchor" id="5912bcc0e4124ac192301f09ecbfd6f6"></span><h2 id="block-5912bcc0e4124ac192301f09ecbfd6f6" class="notion-heading notion-semantic-string">Early warning: you don’t need the whole trace</h2><p id="block-aaf226aac94b45c2a5207163c9f8f24b" class="notion-text notion-text__content notion-semantic-string">A practical question is whether the signal only appears <em>after</em> the model has already failed.</p><p id="block-8723ab214caa4565b0b57e6e6281051b" class="notion-text notion-text__content notion-semantic-string">In the same GSM8K run above, separability is already above chance using short prefixes (e.g., AUC ≈ 0.67 by <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">w = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span></span></span></span></span>) and stays roughly stable as we extend the window.</p><p id="block-d83b49723fad48ed81bf8208e83c58d0" class="notion-text notion-text__content notion-semantic-string">If the curve looks “flat”, that’s the point: <strong>most of the separability is already present very early</strong>, so additional steps don’t add much extra predictive power (at least under this summary statistic).</p><div id="block-f4ff96fdbcfe4f4c949ebc1eaf9d6abf" class="notion-image page-width"><span data-full-size="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/fbb675cd-bb1f-4d9f-a798-8b229b7c645a/early_warning_auc_curve_gsm8k300_llama_greedy/public" data-lightbox-src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/fbb675cd-bb1f-4d9f-a798-8b229b7c645a/early_warning_auc_curve_gsm8k300_llama_greedy/public" style="display:contents"><img alt="Figure 2. Early-warning separability: AUC for predicting wrong answers using prefix max instability " loading="lazy" width="1000" height="1000" decoding="async" data-nimg="1" style="color:transparent;height:auto" srcset="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/fbb675cd-bb1f-4d9f-a798-8b229b7c645a/early_warning_auc_curve_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 1x, https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/fbb675cd-bb1f-4d9f-a798-8b229b7c645a/early_warning_auc_curve_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 2x" src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/fbb675cd-bb1f-4d9f-a798-8b229b7c645a/early_warning_auc_curve_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down"></span><figcaption class="notion-caption notion-semantic-string">Figure 2. Early-warning separability: AUC for predicting wrong answers using prefix max instability <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">S_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> as a function of prefix length <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span> (same GSM8K-300 run).</figcaption></div><div id="block-635d44b0060a4de3bc9b7b7380a8e378" class="notion-divider"></div><span class="notion-heading__anchor" id="8b535b7ab47541409db359fdea9affef"></span><h2 id="block-8b535b7ab47541409db359fdea9affef" class="notion-heading notion-semantic-string">Timing matters: corrective vs destructive instability</h2><p id="block-7ac82cb9dc89448399696b4e36f4852a" class="notion-text notion-text__content notion-semantic-string">Here’s the most important nuance:</p><blockquote id="block-331d5e939d3046c1bd92a07cc923065f" class="notion-quote"><span class="notion-semantic-string">A high instability spike does <em>not</em> automatically mean “the model is failing.”</span></blockquote><p id="block-aebdef9a758e4b9d94421e3785cba701" class="notion-text notion-text__content notion-semantic-string">Sometimes, a model becomes briefly unstable because it is <strong>self-correcting</strong> (switching from a wrong intermediate route to a better one). Other times, instability happens too late, and the model cannot recover.</p><p id="block-af2f771616ef49dbbd2074948b395481" class="notion-text notion-text__content notion-semantic-string">A simple operational proxy is <em>when</em> peak instability occurs.</p><p id="block-0bab281b8ad64b66a64dfeae2b93427a" class="notion-text notion-text__content notion-semantic-string">Let <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>t</mi><mo>∗</mo></msup><mo>=</mo><mi>arg</mi><mo>⁡</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>t</mi></msub><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">t^* = \arg\max_t I_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> be the peak step, <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> be trace length, and define the relative peak position <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><msup><mi>t</mi><mo>∗</mo></msup><mi mathvariant="normal">/</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\rho = t^*/T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span>.</p><ul class="notion-bulleted-list"><li id="block-b332320776934aecb4568e0af4e5d302" class="notion-list-item notion-semantic-string">Early peak (small <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span></span>): the model has remaining budget to recover.</li><li id="block-87fb31c8a9cc44328efa947143d651a1" class="notion-list-item notion-semantic-string">Late peak (large <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span></span></span></span></span>): there may be no time left to stabilize.</li></ul><p id="block-1f53781749dd459b91554a25cc4ca73f" class="notion-text notion-text__content notion-semantic-string">As a sanity check beyond top-<span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> logging, I also ran a small held-out GSM8K set where entropy/JSD are computed from full-vocabulary logits (no truncation). In that run, early-peak traces are much more accurate than late-peak traces (about 46% vs 14%).</p><div id="block-7e59ea8a3d5143f38bf116b147eb6635" class="notion-image page-width"><span data-full-size="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/e854eb56-8330-4926-bef2-7922b6ab6022/peak_timing_accuracy_full_vocab_100trace/public" data-lightbox-src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/e854eb56-8330-4926-bef2-7922b6ab6022/peak_timing_accuracy_full_vocab_100trace/public" style="display:contents"><img alt="Figure 3. Accuracy by relative peak position " loading="lazy" width="1000" height="1000" decoding="async" data-nimg="1" style="color:transparent;height:auto" srcset="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/e854eb56-8330-4926-bef2-7922b6ab6022/peak_timing_accuracy_full_vocab_100trace/w=1920,quality=90,fit=scale-down 1x, https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/e854eb56-8330-4926-bef2-7922b6ab6022/peak_timing_accuracy_full_vocab_100trace/w=1920,quality=90,fit=scale-down 2x" src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/e854eb56-8330-4926-bef2-7922b6ab6022/peak_timing_accuracy_full_vocab_100trace/w=1920,quality=90,fit=scale-down"></span><figcaption class="notion-caption notion-semantic-string">Figure 3. Accuracy by relative peak position <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><msup><mi>t</mi><mo>∗</mo></msup><mi mathvariant="normal">/</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\rho = t^*/T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ρ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span> on a held-out GSM8K run (100 traces) computed from full-vocabulary logits (no top-<span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> truncation).</figcaption></div><p id="block-1c2bc276e40241acb60f349b38547871" class="notion-text notion-text__content notion-semantic-string">To make this concrete, here are two example traces: one correct with an early peak, and one wrong with a late peak.</p><div id="block-3787867247794b5c834b6db71fff1c35" class="notion-image page-width"><span data-full-size="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/c39684f8-9596-43b7-950b-0a1ddeaf7ba6/trace_examples_gsm8k300_llama_greedy/public" data-lightbox-src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/c39684f8-9596-43b7-950b-0a1ddeaf7ba6/trace_examples_gsm8k300_llama_greedy/public" style="display:contents"><img alt="Figure 4 (optional). Two example instability traces (same GSM8K-300 run): a correct trace with an early peak and a wrong trace with a late peak." loading="lazy" width="1000" height="1000" decoding="async" data-nimg="1" style="color:transparent;height:auto" srcset="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/c39684f8-9596-43b7-950b-0a1ddeaf7ba6/trace_examples_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 1x, https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/c39684f8-9596-43b7-950b-0a1ddeaf7ba6/trace_examples_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 2x" src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/c39684f8-9596-43b7-950b-0a1ddeaf7ba6/trace_examples_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down"></span><figcaption class="notion-caption notion-semantic-string">Figure 4 (optional). Two example instability traces (same GSM8K-300 run): a correct trace with an early peak and a wrong trace with a late peak.</figcaption></div><div id="block-3fd67d3cdc32407485129869a9c6adfd" class="notion-divider"></div><span class="notion-heading__anchor" id="9ebf131ffece47c58f2c63b5a49e56e8"></span><h2 id="block-9ebf131ffece47c58f2c63b5a49e56e8" class="notion-heading notion-semantic-string">A small but important limitation: stable-but-wrong failures</h2><p id="block-884b379ff1e7420287cbb1b98341c705" class="notion-text notion-text__content notion-semantic-string">Instability is not a universal explanation of all errors.</p><p id="block-2d3d8cb6422d44959c8fdec12a0958ec" class="notion-text notion-text__content notion-semantic-string">Some failures are <strong>stable-but-wrong</strong>: the model stays confident and consistent, but commits to the wrong solution anyway (knowledge gaps, spurious heuristics, etc.).</p><p id="block-ebc4a537a6894673a65a17c3a5c312b6" class="notion-text notion-text__content notion-semantic-string">This is why I treat instability as a <strong>diagnostic dimension</strong>, not a catch-all label.</p><div id="block-d06b35d47a1f4fd0a7f492a6d0aca335" class="notion-image page-width"><span data-full-size="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/2227ea4f-c749-4920-8d17-2ec151eb9f5d/failure_mode_partition_gsm8k300_llama_greedy/public" data-lightbox-src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/2227ea4f-c749-4920-8d17-2ec151eb9f5d/failure_mode_partition_gsm8k300_llama_greedy/public" style="display:contents"><img alt="Figure 5 (optional). Wrong-trace breakdown on the same GSM8K-300 run: stable wrong (low " loading="lazy" width="1000" height="1000" decoding="async" data-nimg="1" style="color:transparent;height:auto" srcset="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/2227ea4f-c749-4920-8d17-2ec151eb9f5d/failure_mode_partition_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 1x, https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/2227ea4f-c749-4920-8d17-2ec151eb9f5d/failure_mode_partition_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down 2x" src="https://images.spr.so/cdn-cgi/imagedelivery/j42No7y-dcokJuNgXeA0ig/2227ea4f-c749-4920-8d17-2ec151eb9f5d/failure_mode_partition_gsm8k300_llama_greedy/w=1920,quality=90,fit=scale-down"></span><figcaption class="notion-caption notion-semantic-string">Figure 5 (optional). Wrong-trace breakdown on the same GSM8K-300 run: stable wrong (low <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span>), early collapse (high <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>20</mn></msub></mrow><annotation encoding="application/x-tex">S_{20}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>), and unstable wrong (remainder), where <span id="" class="notion-equation notion-equation__inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>20</mn></msub><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>t</mi><mo>≤</mo><mn>20</mn></mrow></msub><msub><mi>I</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_{20} = \max_{t \leq 20} I_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9285em;vertical-align:-0.2452em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">≤</span><span class="mord mtight">20</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2452em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>.</figcaption></div><div id="block-11b72975c4034eaa9871dad4881ca5c6" class="notion-divider"></div><span class="notion-heading__anchor" id="a3a321232c8b4c90b1907198523cb387"></span><h2 id="block-a3a321232c8b4c90b1907198523cb387" class="notion-heading notion-semantic-string">What this diagnostic is (and is not)</h2><p id="block-84cf3cd994f54071904d252799dc15e6" class="notion-text notion-text__content notion-semantic-string">What it <em>is</em>:</p><ul class="notion-bulleted-list"><li id="block-06a3bbe4a2314e67af2d7fc73ffbf74a" class="notion-list-item notion-semantic-string">A lightweight, inference-time “health monitor” for reasoning trajectories.</li><li id="block-5badc01456ef41da925583506ea9524f" class="notion-list-item notion-semantic-string">A way to compare models, datasets, and decoding settings by <em>process dynamics</em>, not just accuracy.</li><li id="block-b7aa8e66208744b698b8939f953b040f" class="notion-list-item notion-semantic-string">A tool for studying <em>when</em> and <em>how</em> reasoning collapses.</li></ul><p id="block-b6426788d32c4dacab13f94b8488f78d" class="notion-text notion-text__content notion-semantic-string">What it is <em>not</em>:</p><ul class="notion-bulleted-list"><li id="block-838ea694e1f24a75acfc859ae00dcf0d" class="notion-list-item notion-semantic-string">Not a stabilization method.</li><li id="block-23ba667a5b32456ca317f810dcf8ba38" class="notion-list-item notion-semantic-string">Not an intervention that claims to improve accuracy.</li></ul><div id="block-7454a6d8aec3410e8ee083fc74a08906" class="notion-divider"></div><div id="block-504581a2bd6443bf89447b46d020a5f7" class="notion-toggle closed"><div class="notion-toggle__summary"><div class="notion-toggle__trigger"><div class="notion-toggle__trigger_icon"><span>‣</span></div></div><span class="notion-semantic-string">Implementation sketch (from logged top-k logprobs)</span></div><div class="notion-toggle__content"><div id="block-d394ba85c9c545c3bbb08cec18563b78" class="notion-code no-wrap"><button class="notion-code__copy-button"><svg class="notion-icon notion-icon__copy" viewBox="0 0 14 16"><path d="M2.404 15.322h5.701c1.26 0 1.887-.662 1.887-1.927V12.38h1.154c1.254 0 1.91-.662 1.91-1.928V5.555c0-.774-.158-1.266-.626-1.74L9.512.837C9.066.387 8.545.21 7.865.21H5.463c-1.254 0-1.91.662-1.91 1.928v1.084H2.404c-1.254 0-1.91.668-1.91 1.933v8.239c0 1.265.656 1.927 1.91 1.927zm7.588-6.62c0-.792-.1-1.161-.592-1.665L6.225 3.814c-.452-.462-.844-.58-1.5-.591V2.215c0-.533.28-.832.843-.832h2.38v2.883c0 .726.386 1.113 1.107 1.113h2.83v4.998c0 .539-.276.832-.844.832H9.992V8.701zm-.79-4.29c-.206 0-.288-.088-.288-.287V1.594l2.771 2.818H9.201zM2.503 14.15c-.563 0-.844-.293-.844-.832V5.232c0-.539.281-.837.85-.837h1.91v3.187c0 .85.416 1.26 1.26 1.26h3.14v4.476c0 .54-.28.832-.843.832H2.504zM5.79 7.816c-.24 0-.346-.105-.346-.345V4.547l3.223 3.27H5.791z"></path></svg>Copy</button><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Inputs: per-step top-k logprobs: logp[t] = {token: log_prob}</span>
<span class="token comment"># Output: instability strength S</span>

<span class="token keyword">def</span> <span class="token function">renormalize</span><span class="token punctuation">(</span>logp_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Convert to probabilities and renormalize on logged support</span>
    probs <span class="token operator">=</span> <span class="token punctuation">{</span>tok<span class="token punctuation">:</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>lp<span class="token punctuation">)</span> <span class="token keyword">for</span> tok<span class="token punctuation">,</span> lp <span class="token keyword">in</span> logp_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    z <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>probs<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>tok<span class="token punctuation">:</span> p <span class="token operator">/</span> z <span class="token keyword">for</span> tok<span class="token punctuation">,</span> p <span class="token keyword">in</span> probs<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">entropy</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token builtin">sum</span><span class="token punctuation">(</span>pi <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>pi<span class="token punctuation">)</span> <span class="token keyword">for</span> pi <span class="token keyword">in</span> p<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> pi <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">jsd</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Compute on union support by zero-padding</span>
    keys <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token builtin">set</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token punctuation">{</span>k<span class="token punctuation">:</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">+</span> q<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> keys<span class="token punctuation">}</span>
    <span class="token keyword">def</span> <span class="token function">kl</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>ai <span class="token operator">*</span> math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>ai <span class="token operator">/</span> b<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span> ai <span class="token keyword">in</span> a<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> ai <span class="token operator">&gt;</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">0.5</span> <span class="token operator">*</span> kl<span class="token punctuation">(</span>p<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token operator">*</span> kl<span class="token punctuation">(</span>q<span class="token punctuation">,</span> m<span class="token punctuation">)</span>

p_prev <span class="token operator">=</span> <span class="token boolean">None</span>
I <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p_t <span class="token operator">=</span> renormalize<span class="token punctuation">(</span>logp<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span>
    H_t <span class="token operator">=</span> entropy<span class="token punctuation">(</span>p_t<span class="token punctuation">)</span>
    <span class="token keyword">if</span> p_prev <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        D_t <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        D_t <span class="token operator">=</span> jsd<span class="token punctuation">(</span>p_t<span class="token punctuation">,</span> p_prev<span class="token punctuation">)</span>
    I_t <span class="token operator">=</span> D_t <span class="token operator">+</span> <span class="token number">1.0</span> <span class="token operator">*</span> H_t  <span class="token comment"># lambda = 1</span>
    I<span class="token punctuation">.</span>append<span class="token punctuation">(</span>I_t<span class="token punctuation">)</span>
    p_prev <span class="token operator">=</span> p_t

S <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span></code></pre><figcaption class="notion-caption notion-semantic-string"></figcaption></div></div></div><div id="block-39ec45b8151b43ad9d62e7857013ae75" class="notion-toggle closed"><div class="notion-toggle__summary"><div class="notion-toggle__trigger"><div class="notion-toggle__trigger_icon"><span>‣</span></div></div><span class="notion-semantic-string">中文摘要</span></div><div class="notion-toggle__content"><p id="block-f172ca8819f9433ea1d8bf7fd5732285" class="notion-text notion-text__content notion-semantic-string">我们常把 LLM 的错误当成“突然崩掉”，但推理其实是一个逐步演化的过程。</p><p id="block-580433892970404e9c9b56729c03e41f" class="notion-text notion-text__content notion-semantic-string">这篇文章介绍一个纯诊断信号：只用每步的 top-k token 概率（logprobs）就能计算不稳定性 <code class="code">I_t</code>，并用峰值 <code class="code">S</code> 衡量整条推理轨迹的“动态失稳强度”。</p><p id="block-c4a483e6f4914d518fa1bda67359246d" class="notion-text notion-text__content notion-semantic-string">经验上，<code class="code">S</code> 与失败风险相关，并且在只看前几十步时就已具备一定的 early-warning 区分能力。</p><p id="block-144c49fe404c4ae8932c819188bad1ef" class="notion-text notion-text__content notion-semantic-string">更关键的是：不稳定并不总是坏事。早期的不稳定可能对应“自我修正”（recoverable），晚期的不稳定更像“不可恢复的偏离”（irrecoverable）。</p></div></div></article></main>